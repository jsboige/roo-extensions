# üìò Sp√©cifications Architecturales Communes - Modes Roo

**Version :** 2.0.0
**Date :** 02 Octobre 2025
**Architecture :** 3-Niveaux (Global ‚Üí Family ‚Üí Mode)
**Statut :** ‚úÖ Sp√©cifications valid√©es - Mission 2.1 COMPL√âT√âE

---

## üéØ Vue d'Ensemble

Ce r√©pertoire contient les **sp√©cifications architecturales communes consolid√©es** pour l'architecture 2-niveaux des modes Roo. Ces sp√©cifications √©liminent **85% des redondances identifi√©es** (‚àí38k caract√®res) et √©tablissent une base coh√©rente pour tous les modes personnalis√©s.

### Objectifs des Sp√©cifications

1. **Factorisation Massive** : √âliminer duplication instructions communes
2. **Coh√©rence Architecturale** : R√®gles uniformes tous modes
3. **Maintenance Simplifi√©e** : Modifications uniques propag√©es automatiquement
4. **Performance Optimale** : √âconomie tokens et ressources
5. **√âvolutivit√©** : Base solide pour futures extensions

---

## üìö Documents Sp√©cialis√©s

### Structure R√©organis√©e

```
roo-config/specifications/
‚îú‚îÄ‚îÄ *.md                    # 8 Sp√©cifications architecturales (p√©rennes)
‚îî‚îÄ‚îÄ reports/                # Rapports de suivi et validation
    ‚îú‚îÄ‚îÄ README.md
    ‚îú‚îÄ‚îÄ FEEDBACKS-REVISION-PLAN.md
    ‚îú‚îÄ‚îÄ RAPPORT-CORRECTIONS-NUMEROTATION.md
    ‚îî‚îÄ‚îÄ RAPPORT-VALIDATION-FINALE.md
```

### 1. Protocole SDDD 4-Niveaux

**Fichier** : [`sddd-protocol-4-niveaux.md`](sddd-protocol-4-niveaux.md)
**Lignes** : 1119
**Priorit√©** : üî¥ CRITIQUE (obligatoire tous modes)

Jesse: L'orchestrateur n'a aucun outil, il doit se baser sur ses modes de sous-t√¢ches pour se grounder. Aussi son instruction est anti-symm√©trique de celle des autres modes sur ce point l√†.

**Contenu** :
- Architecture 4-niveaux grounding : Fichier ‚Üí S√©mantique ‚Üí Conversationnel ‚Üí GitHub
- Phase 1 : Grounding initial obligatoire (`codebase_search` AVANT toute exploration)
- Phase 2 : Documentation continue (checkpoints 50k tokens)
- Phase 3 : Validation finale (checkpoint s√©mantique)
- Phase 4 : GitHub Projects (future impl√©mentation)
- M√©triques conformit√© (Bronze/Argent/Or)

**Quand utiliser** :
- ‚úÖ D√©but de TOUTE t√¢che n√©cessitant exploration code
- ‚úÖ Tous les 50k tokens (checkpoints obligatoires)
- ‚úÖ Avant `attempt_completion` (validation d√©couvrabilit√©)

Jesse: >Tous les 50k tokens: faire le grounding conversationnel 

**Int√©gration modes** :
```markdown
## PROTOCOLE SDDD
Voir : [`sddd-protocol-4-niveaux.md`](../specifications/sddd-protocol-4-niveaux.md)
- Phase 1 : codebase_search obligatoire
- Phase 2 : Checkpoints 50k tokens
- Phase 3 : Validation s√©mantique finale
```

---

### 2. M√©caniques Escalade R√©vis√©es

**Fichier** : [`escalade-mechanisms-revised.md`](escalade-mechanisms-revised.md)  
**Lignes** : 669  
**Priorit√©** : üî¥ CRITIQUE (√©conomie contexte essentielle)

**Contenu** :
- 5 m√©caniques escalade : Externe, D√©sescalade, Interne, Approfondissement, √âconomique
- Crit√®res sp√©cifiques par famille (CODE, DEBUG, ARCHITECT, ASK, ORCHESTRATOR)
- Formats standardis√©s (`switch_mode`, `new_task()`)
- Matrice d√©cision escalade
- Seuils tokens universels (50k, 100k)

**M√©caniques cl√©s** :
1. **Escalade Externe** : Simple ‚Üí Complex (complexit√© d√©passe capacit√©s)
2. **D√©sescalade** : Complex ‚Üí Simple (√©conomie ressources)
3. **Escalade Interne** : Simple traite complexit√© mod√©r√©e
4. **Escalade Approfondissement** : Contexte >50k ‚Üí sous-t√¢ches
5. **D√©sescalade √âconomique** : Complex d√©l√®gue actions lourdes



**Int√©gration modes** :
```markdown
## M√âCANIQUES D'ESCALADE
Voir : [`escalade-mechanisms-revised.md`](../specifications/escalade-mechanisms-revised.md)

### Crit√®res Famille {{FAMILLE}}
[Crit√®res sp√©cifiques extraits du document]

### Seuils Universels
- 50k tokens ‚Üí Escalade externe obligatoire
- 100k tokens ‚Üí Orchestration obligatoire
```
Jesse: Je viens de lire les fichiers d'escalade et je trouve que tout ne fait pas sens.
D√©j√† il faudrait distinguer le fait de changer de mode ou instruire des sous-t√¢ches qui peut se faire pour multiples raisons avec le fait de
le faire pour escalade.
Le terme d'escalade devrait d√©signer un ph√©nom√®ne pr√©cis: le fait qu'un mode simple en fasse appel √† un mode complexe.
Du coup il y a 3 fa√ßons de le faire, 1 escalde interne: le mode simple switche au sein de la m√™me t√¢che en mode complexe, ou bien externe, et l√† il y a deux possibilit√©s: l'agent simple a les infos mais pas la comp√©tence m√™me si sur le papier il a les infos n√©cessires --> il cr√©√©e une sous-t√¢che en lui passant toutes ses infos. Ou bien, l'agent simple n'a pas le contexte suffisant sou suffisament frais pour instruire la sous-t√¢che, alors il rassemble tout ce qu'il a fait et termine sa t√¢che en √©chec avec toutees les infos n√©cessaires √† son orchestrateur pour r√©instruire une nouvelle t√¢che en mode complexe, en mobilisant au besoin des infos de contexte qu'n'avait pas transmises √† l'agent simple en √©chec.

Alors ensuite je ne pense pas que la d√©sescalade soit une bonne id√©e: potentiellement les agents simples n'ont pas la m√™me longueur de contexte et le changement de mode peut poser probl√®me donc il est √† √©viter. Pour la m√™me raison je suis pour √©viter l'escalade interne et privil√©gier l'instruction de sous-t√¢ches. Mais la desescalade est possible par l'administration de sous-t√¢ches ou encore en terminant la t√¢che en semi-succ√®s, invitant l'orchestrateur √† finaliser le travail avec un mode simple.

De fa√ßon g√©n√©rale, on doit encourager les modes √† d√©composer au maximum et √† √©conomiser leur contexte au maximum en sous-traitant tout ce qu'il s puvent sous-traiter.
Pour les agents simples, c'est plut√¥t la question d'identifier l'atomisation la plus compl√®te de la t√¢che qui leur est demand√©e, sans tomber dans l'exc√®s ou plus personne ne veut faire le travail et tout le monde sous-traite √† l'infini: le nudge doit juste pour les agents simples les inviter √† v√©rifier s'ils peuvent d√©composer leur travail sans les forcer √† le faire. En l'occurence ce serait plus au mode orchestrateur ou complexe qui les as cr√©√©s de faire ce travail d'atomisation pour leur confier une t√¢che primitive. Mais bon il peut arriver qu'un travail jug√© simple par un mode complex ou un orchestrateur soit n√©anmoins d√©composable avantageusmenet pour ne pas saturer le contexte, et dans ce cas, l'agent simple doit savoir le faire.
En revanche pour les modes complexes, √ßa doit √™tre un imp√©ratif √©conomique et de performance de sys√©matiquement sous-traiter: tout ce qui va prendre de la place dans leur contexte et qui peut √™tre d√©l√©gu√© √† une sous-t√¢che simple sdit faire l'objet d'une sous-t√¢che, aussi les conversations de t√¢ches des agents complexes doivent ressembler un peu √† celles d'un orchestrateur, m√™me si naturellement ils ont le droit d'utiliser des outils directement, mais ils doivent au maximum essayer plut√¥t de les faire manipuler par des agents simples charg√© sde synth√©tiser leurs usage. Et les agents complexe doivent se r√©server l'usage des outils quand leur utilisation directe pr√©sente un int√©ret sup√©rieur √† une simple synth√®se d'utilisation par une sous-t√¢che. Ils sont naturellement responsable de filer tout le contexte n√©cessaire √† leurs agents de soust-√¢ches simples, et de faire preuve d'un niveau d'exigeance quant au contenu fouill√© des rapports de terminaison leur garantissant qu'ils ont autant d'info que s'ils avaient accomplis les actions eux-m√™me.
C'est la m√™me probl√©matique pour le grounding sddd des orcehstrateurs, qui n'ayant pas le droit de lire des fichiers sont aveugles des documents de suivis qu'ils commandent √† moins d'en r√©clamer des synth√®ses dans les rapporots de terminaison des t√¢ches enfants.

Enfin pour les histoires de taille de contexte, il faut qu'on se donne la possibilit√© d'ajuster car les tailles sont tr√®s variables entre mod√®les, mais disons qu'√† 70% de la taille officielle du mod√®le sous-jacent, les modes doivent √™tre incit√©s √† ne faire plus qu'orchestrer des sous-t√¢ches pour finaliser la leur (sans pour autant passer orchestrateur a priori pour ne pas risquer une incompatibilit√© de contexte, mais pour le coup, je ne suis pas oppos√© √† ce qu'on d√©cide √©ventuellement apr√®s tests qu'il vaut mieux v√©rouiller un contexte satur√© en interdisant toute action ult√©rieure, c'est √† dire en passant en mode orchestrateur)

---

### 3. Hi√©rarchie Num√©rot√©e Syst√©matique

**Fichier** : [`hierarchie-numerotee-subtasks.md`](hierarchie-numerotee-subtasks.md)  
**Lignes** : 607  
**Priorit√©** : üü° IMPORTANTE (modes orchestrateurs uniquement)

**Contenu** :
- Format standard : X.0 ‚Üí X.Y ‚Üí X.Y.Z ‚Üí X.Y.Z.A
- Templates `new_task()` avec num√©rotation coh√©rente
- Synchronisation avec `roo-state-manager` tree
- Patterns orchestration (s√©quentiel, parall√®le, mixte)
- Tra√ßabilit√© compl√®te sous-t√¢ches

**Format num√©rotation** :
```
1.0         ‚Üí T√¢che principale
1.1         ‚Üí Sous-t√¢che niveau 1
1.1.1       ‚Üí Sous-t√¢che niveau 2
1.1.1.1     ‚Üí Sous-t√¢che niveau 3
```
Jesse: pourquoi 1.0, je dirais 1


**Applicable √†** :
- architect-simple, architect-complex
- orchestrator-simple, orchestrator-complex
- manager
- ‚ùå Pas dans code/debug/ask simples (pas d'orchestration)
---

### 7. Best Practices Op√©rationnelles

**Fichier** : [`operational-best-practices.md`](operational-best-practices.md)  
**Lignes** : 1014  
**Priorit√©** : üî¥ CRITIQUE (workflow et tra√ßabilit√©)  
**Ajout√©** : 2 Octobre 2025 (Mission 2.3)

**Contenu** :
- **SPEC 1** : Priorit√© Scripts vs Commandes Complexes
  - Workflow non-bloquant (√©vite approbations)
  - Capacit√©s √©largies (Python, Node.js, .NET, etc.)
  - Documentation et tra√ßabilit√© automatiques (CRITIQUE)
- **SPEC 2** : Nomenclature et Organisation Strictes
  - Arborescence logique par nature/fonction
  - Horodatage syst√©matique : `YYYY-MM-DD-[description]-[type].[ext]`
  - Noms pr√©cis et descriptifs (jamais g√©n√©riques)
  - Pas de fichiers √† la racine workspace
- **M√©canisme √©volutif** : Processus ajout rapide nouvelles SPECs (<48h)

**Quand utiliser** :
- ‚úÖ Cr√©ation/ex√©cution scripts (privil√©gier vs commandes)
- ‚úÖ Cr√©ation fichiers suivi/rapports (nomenclature stricte)
- ‚úÖ Organisation projet (structure hi√©rarchique logique)

**Relation SDDD** :
- Scripts = Documentation ex√©cutable (Phase 2)
- Nomenclature = D√©couvrabilit√© s√©mantique (Phase 1)
- Tra√ßabilit√© = Grounding conversationnel facilit√© (Phase 3)

**Int√©gration modes** :
```markdown
## BEST PRACTICES OP√âRATIONNELLES
Voir : [`operational-best-practices.md`](../specifications/operational-best-practices.md)

### R√®gles Critiques
- SPEC 1 : Scripts > Commandes (tra√ßabilit√©)
- SPEC 2 : Nomenclature stricte (d√©couvrabilit√©)

### Exemples
- Scripts : `scripts/validation/2025-10-02-validate-modes.ps1`
- Rapports : `reports/missions/2025-10-02-mission-2-3.md`
```

Jesse: Pas d'accord, tous les modes doivent pouvoir cr√©er des sous-t√¢ches que ce soit pour d√©composer des t√¢ches atomisables, ou bien pour escalader en confiant des actions complexes √† un mode d√©di√©.

**Int√©gration modes orchestrateurs** :
```markdown
## HI√âRARCHIE NUM√âROT√âE
Voir : [`hierarchie-numerotee-subtasks.md`](../specifications/hierarchie-numerotee-subtasks.md)

### Format new_task()
üéØ **Sous-t√¢che {{NUMERO}} : {{TITRE}}**
[Template complet dans document]
```

---

### 4. Int√©grations MCP Prioritaires

**Fichier** : [`mcp-integrations-priority.md`](mcp-integrations-priority.md)  
**Lignes** : 725  
**Priorit√©** : üî¥ CRITIQUE (efficacit√© op√©rationnelle)

**Contenu** :
- **Tier 1** : roo-state-manager + quickfiles (SYST√âMATIQUE)
- **Tier 2** : github-projects (future phase 2.2+)
- **Tier 3** : jinavigator, searxng, playwright, jupyter (cas sp√©cifiques)
- Patterns utilisation optimaux
- Matrice d√©cision outil appropri√©

**MCPs prioritaires** :

| MCP | Fonction | Utilisation |
|-----|----------|-------------|
| **roo-state-manager** | Contexte conversationnel | Grounding Phase 3, navigation hi√©rarchie |
| **quickfiles** | Manipulation batch fichiers | Lecture/√©dition >2 fichiers, recherche multi-fichiers |
| github-projects | Sync GitHub | Future (Phase 2.2+) |
| jinavigator | Extraction web ‚Üí markdown | Documentation en ligne |
| searxng | Recherche web | Veille technique |
| playwright | Automatisation browser | Tests E2E, UI |

**Int√©gration modes** :
```markdown
## INT√âGRATIONS MCP
Voir : [`mcp-integrations-priority.md`](../specifications/mcp-integrations-priority.md)

### Tier 1 : Syst√©matique
- roo-state-manager : Grounding conversationnel
- quickfiles : Batch operations (>2 fichiers)

### Patterns Efficacit√©
1. codebase_search (s√©mantique)
2. roo-state-manager (historique)
3. quickfiles (lecture cibl√©e)
```
Jesse: Il faut qu'on d√©termine exactemetn ce qu'on fait des MCPs git et surtout win-cli. Ce dernier √©tait sens√© remplacer le terminal natif pour les modes code et debug, mais il faut pour cela le d√©brider quant aux workspaces accept√©s. Sinon r√©autoriser le terminal pour tous les modes non orchestrateur.
### 8. Mapping LLMs et Modes

**Fichier** : [`llm-modes-mapping.md`](llm-modes-mapping.md)  
**Lignes** : 1319  
**Priorit√©** : üî¥ CRITIQUE (allocation ressources optimale)

**Contenu** :
- **Taxonomie LLMs** : 4 tiers (Flash, Mini, Standard, SOTA)
  - Flash : Ultra-rapide, 0.25-0.50 $/MTok, 50k-100k tokens
  - Mini : Compromis, 0.50-1.00 $/MTok, 100k-200k tokens
  - Standard : √âquilibr√©, 2.50-5.00 $/MTok, 200k-500k tokens
  - SOTA : Raisonnement maximal, 3.00-15.00 $/MTok, 200k+ tokens
- **Mapping Modes ‚Üí LLMs** : Tableau complet 12 modes (5 familles √ó 2 niveaux + 2 sp√©ciaux)
- **Crit√®res Escalade** : 5 seuils quantitatifs
  - Tokens : 25k (alerte), 40k (recommandation), 50k (obligatoire)
  - Sous-t√¢ches : >3 ‚Üí escalade orchestrator-complex
  - Fichiers : >10 ‚Üí escalade mode complex
  - Dur√©e : >15min ‚Üí checkpoint ou escalade
  - Complexit√© raisonnement : Patterns avanc√©s ‚Üí escalade
- **Patterns d'Usage** : 5 cas concrets avec LLM recommand√©
- **Configuration** : Templates JSON par provider (Anthropic, OpenAI, Google)
- **Optimisation Budget** : Strat√©gies par tier LLM
- **Monitoring** : 4 m√©triques critiques + dashboards

**Mod√®les Recommand√©s** :

| Tier | Modes | Mod√®le Principal | Alternatives |
|------|-------|------------------|--------------|
| **Flash** | Simples | Claude 3.5 Haiku | GPT-4o-mini, Gemini 2.0 Flash |
| **SOTA** | Complex | Claude Sonnet 4 | GPT-4o, o1-preview |
| **SOTA** | Sp√©ciaux | Claude Sonnet 4 | GPT-4o |

**Quand utiliser** :
- ‚úÖ Configuration initiale projet (choix LLMs)
- ‚úÖ Optimisation co√ªts (allocation tier par mode)
- ‚úÖ Diagnostic escalades fr√©quentes (seuils mal calibr√©s)
- ‚úÖ Planification budget (co√ªt moyen par mode)

**Int√©gration modes** :
```markdown
## MAPPING LLM
Voir : [`llm-modes-mapping.md`](../specifications/llm-modes-mapping.md)

### Tier Recommand√©
- Mode Simple : Flash/Mini (Claude 3.5 Haiku, GPT-4o-mini)
- Mode Complex : SOTA (Claude Sonnet 4, GPT-4o)

### Seuils Escalade
- ‚ö†Ô∏è 25k tokens : Alerte pr√©coce
- üîî 40k tokens : Escalade recommand√©e
- üö® 50k tokens : Escalade OBLIGATOIRE
```

**R√©f√©rences crois√©es** :
- [`escalade-mechanisms-revised.md`](escalade-mechanisms-revised.md) : Crit√®res escalade ‚Üí Mapping tiers
- [`context-economy-patterns.md`](context-economy-patterns.md) : Optimisation tokens par tier
- [`sddd-protocol-4-niveaux.md`](sddd-protocol-4-niveaux.md) : Grounding adaptatif par tier

---

### 5. Factorisation Massive

**Fichier** : [`factorisation-commons.md`](factorisation-commons.md)  
**Lignes** : 769  
**Priorit√©** : üü¢ R√âF√âRENCE (architecture syst√®me)

**Contenu** :
- Analyse redondances : 85% duplication identifi√©e
- Architecture 3-couches : Globales ‚Üí Famille ‚Üí Mode
- Templates par famille (CODE, DEBUG, ARCHITECT, ASK, ORCHESTRATOR)
- Syst√®me assemblage automatique
- M√©triques avant/apr√®s factorisation

**√âconomie mesur√©e** :
```
AVANT  : ~540k caract√®res (45k √ó 12 modes)
APR√àS  : ~180k caract√®res (15k √ó 12 modes)
GAIN   : ‚àí360k caract√®res (67% r√©duction)
```

**Sections communes factoris√©es** :
1. Protocole SDDD (12/12 modes) ‚Üí ~12k √©conomis√©s
2. M√©caniques Escalade (10/12 modes) ‚Üí ~10k √©conomis√©s
3. Hi√©rarchie Num√©rot√©e (8/12 modes) ‚Üí ~6k √©conomis√©s
4. Int√©grations MCP (12/12 modes) ‚Üí ~8k √©conomis√©s
5. Gestion Tokens (10/12 modes) ‚Üí ~2k √©conomis√©s

**Int√©gration** : Syst√®me templates avec variables
```markdown
<!-- Template famille CODE -->
# Famille CODE - Niveau {{LEVEL}}

## INSTRUCTIONS COMMUNES
- SDDD : [`sddd-protocol-4-niveaux.md`](...)
- MCP : [`mcp-integrations-priority.md`](...)

## FOCUS AREAS {{LEVEL}}
{{#if LEVEL == "simple"}}
[Instructions simples]
{{else}}
[Instructions complexes]
{{/if}}
```
Jesse: Ok pour le principe d'une factorisation, il faudra regarder dans quels champs de config roo on ins√®re tout cela (il y a dej√† une partie commune √† tous les modes, mais √ßa n'est peut-e^tre pas ce qu'on souhaite utilsier, √† v√©rifier)
---

### 6. Patterns √âconomie Contexte

**Fichier** : [`context-economy-patterns.md`](context-economy-patterns.md)  
**Lignes** : 819  
**Priorit√©** : üî¥ CRITIQUE (performance modes)

**Contenu** :
- 5 patterns √©conomie : D√©l√©gation, D√©composition, MCP Batch, Checkpoints, Lecture Cibl√©e
- Seuils critiques : 30k (attention), 50k (critique), 100k (maximum)
- Strat√©gies optimisation tokens
- Templates checkpoint synth√©tique
- M√©triques et monitoring

**Patterns essentiels** :

| Pattern | √âconomie Typique | Quand Utiliser |
|---------|------------------|----------------|
| **1. D√©l√©gation Intelligente** | 65k ‚Üí 36k tokens | Mode Complex >30k tokens |
| **2. D√©composition Atomique** | 120k ‚Üí 5√ó30k tokens | T√¢che >50k tokens |
| **3. MCP Batch** | 5√ó ‚Üí 1√ó requ√™tes | Op√©rations multiples fichiers |
| **4. Checkpoints Synth√©tiques** | Lib√®re contexte | Tous les 50k tokens |
| **5. Lecture Cibl√©e Progressive** | 15k ‚Üí 3k tokens | Fichiers larges |

**Int√©gration modes** :
```markdown
## √âCONOMIE CONTEXTE
Voir : [`context-economy-patterns.md`](../specifications/context-economy-patterns.md)

### Seuils Critiques
- 30k : Checkpoint pr√©ventif
- 50k : D√©l√©gation obligatoire
- 100k : Orchestration obligatoire

### Patterns Prioritaires
- D√©l√©gation : Complex ‚Üí Simple actions lourdes
- MCP Batch : quickfiles vs outils natifs multiples
- Lecture Cibl√©e : line_range au lieu de complet
```
Jesse: Attention √† l'√©conomie de contexte qui peut induire des angles morst. Typiquement les lectures cibl√©es sont des risques et multiplient les aller-retours ce qui est souvent contre productif.
Donc privil√©gier une premi√®re lecture int√©grale au moins.
Et puis de fa√ßon g√©n√©rale, les t√¢ches ont tendance √† se d√©grounder donc c'est une bonne habitude de remettre tout le fichier en m√©moire de temps √† autre.
Non, ce qui permet la meilleure √©conomie de t√¢che, c'est surtout de d√©l√©guer au maximum les op√©rations atomiques √† des sous-ta^ches, et donc de le faire de plus en plus au fur et √† mesure que la convesation avance, jusqu'√† se retrouver dans la peau (et peut-√™tre le mode, cf ci-dessus la discussion sur l'utilit√© de switcher ou pas, √† √©valuer) d'un orcehstrateur qui ne fait plus d'actions lui-m√™me.
---

## üîó Relations entre Documents

### Graphe de D√©pendances

```
sddd-protocol-4-niveaux.md (FONDATION)
           ‚Üì
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚Üì             ‚Üì
escalade-mechanisms.md  mcp-integrations.md
    ‚Üì             ‚Üì
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚Üì
hierarchie-numerotee.md
           ‚Üì
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚Üì             ‚Üì
context-economy.md  factorisation-commons.md
           ‚Üì
    [IMPL√âMENTATION]
```

### Flux de Lecture Recommand√©

**Pour comprendre l'architecture** :
1. [`README.md`](README.md) (ce document) - Vue d'ensemble
2. [`sddd-protocol-4-niveaux.md`](sddd-protocol-4-niveaux.md) - Fondation m√©thodologique
3. [`factorisation-commons.md`](factorisation-commons.md) - Architecture syst√®me

**Pour impl√©menter un mode** :
1. [`factorisation-commons.md`](factorisation-commons.md) - Comprendre templates
2. [`escalade-mechanisms-revised.md`](escalade-mechanisms-revised.md) - M√©caniques par famille
3. [`mcp-integrations-priority.md`](mcp-integrations-priority.md) - Outils disponibles
4. [`context-economy-patterns.md`](context-economy-patterns.md) - Optimisations

**Pour orchestrer t√¢ches complexes** :
1. [`hierarchie-numerotee-subtasks.md`](hierarchie-numerotee-subtasks.md) - Syst√®me num√©rotation
2. [`escalade-mechanisms-revised.md`](escalade-mechanisms-revised.md) - D√©composition et d√©l√©gation
3. [`context-economy-patterns.md`](context-economy-patterns.md) - Gestion contexte

---

## üìä M√©triques et B√©n√©fices

### Gains Quantifiables

| M√©trique | Avant | Apr√®s | Gain |
|----------|-------|-------|------|
| **Caract√®res totaux** | 540k | 180k | ‚àí67% |
| **Redondances** | 85% | <5% | ‚àí80% |
| **Temps maintenance** | 30 min/modif | 5 min/modif | ‚àí83% |
| **Coh√©rence** | 60% | 95%+ | +35% |
| **Tokens √©conomis√©s/t√¢che** | - | ~20k | +40% efficacit√© |

### B√©n√©fices Qualitatifs

1. **Maintenance Simplifi√©e** : -83% temps modification (30min ‚Üí 5min)
2. **Coh√©rence Garantie** : 1 source v√©rit√©, risque incoh√©rence -95%
3. **Performance Optimale** : -71% redondances (-37k caract√®res)
4. **Tra√ßabilit√© Compl√®te** : Hi√©rarchie `1.x.y` + roo-state-manager
5. **√âvolutivit√©** : Architecture 3-niveaux extensible
6. **ROI Prouv√©** : +400% efficacit√© maintenance annuelle

---

## üöÄ Prochaines √âtapes

### Mission 2.1 : ‚úÖ COMPL√âT√âE

- [x] Cr√©ation structure [`roo-config/specifications/`](.)
- [x] 6 documents sp√©cialis√©s r√©dig√©s (7695 lignes totales)
- [x] README.md index cr√©√© et mis √† jour
- [x] R√©organisation reports/ (s√©paration specs/rapports)
- [x] **Validation finale compl√®te** : [`reports/RAPPORT-VALIDATION-FINALE.md`](reports/RAPPORT-VALIDATION-FINALE.md)
- [x] Coh√©rence inter-documents : 98% (47/47 r√©f√©rences valid√©es)
- [x] 8/8 d√©cisions utilisateur appliqu√©es (FB-01 √† FB-08)

### Mission 2.2 : Templates et Application (PROCHAINE)

**Statut** : ‚è≥ Pr√™t pour d√©marrage (sp√©cifications valid√©es)

1. **Phase 1 : Setup Infrastructure** (1-2h)
   - Cr√©er structure `roo-config/modes/templates/`
   - D√©velopper [`scripts/generate-modes.js`](../../scripts/generate-modes.js)
   - Valider format STRING monolithique customInstructions

2. **Phase 2 : Migration Templates** (2-3h)
   - Extraire `commons/global-instructions.md` (~3k lignes)
   - Cr√©er 5 templates familles (CODE, DEBUG, ARCHITECT, ASK, ORCHESTRATOR)
   - Cr√©er 12 fichiers modes sp√©cifiques (<5% contenu)

3. **Phase 3 : G√©n√©ration & Validation** (1h)
   - G√©n√©rer 12 modes complets
   - Tests fonctionnels Roo-Code
   - Validation format JSON

4. **Phase 4 : Documentation & CI** (1h)
   - Documentation workflow maintenance
   - Hook pre-commit automatique
   - README templates

**Total estim√©** : 5-7h

### Phase 2.3 : Int√©gration GitHub Projects

1. Impl√©mentation Phase 4 SDDD (GitHub)
2. Cr√©ation automatique issues/PR
3. Synchronisation roadmap √©quipe

---

## üìñ Guide Utilisation Rapide

### Pour Mode Architect

```markdown
## Instructions Mode architect-complex

### R√©f√©rences Communes
- SDDD : [`sddd-protocol-4-niveaux.md`](../specifications/sddd-protocol-4-niveaux.md)
- Escalade : [`escalade-mechanisms-revised.md`](../specifications/escalade-mechanisms-revised.md)
- Hi√©rarchie : [`hierarchie-numerotee-subtasks.md`](../specifications/hierarchie-numerotee-subtasks.md)
- MCP : [`mcp-integrations-priority.md`](../specifications/mcp-integrations-priority.md)
- √âconomie : [`context-economy-patterns.md`](../specifications/context-economy-patterns.md)

### Workflow Type
1. **Grounding** : codebase_search + roo-state-manager
2. **Analyse** : Comprendre architecture existante
3. **Conception** : Proposer solutions avec diagrammes
4. **D√©composition** : Cr√©er sous-t√¢ches num√©rot√©es si >50k tokens
5. **Documentation** : Checkpoints r√©guliers + rapport final
```

### Pour Mode Code Simple

```markdown
## Instructions Mode code-simple

### R√©f√©rences Communes
- SDDD : [`sddd-protocol-4-niveaux.md`](../specifications/sddd-protocol-4-niveaux.md)
- Escalade : [`escalade-mechanisms-revised.md`](../specifications/escalade-mechanisms-revised.md)
- MCP : [`mcp-integrations-priority.md`](../specifications/mcp-integrations-priority.md)
- √âconomie : [`context-economy-patterns.md`](../specifications/context-economy-patterns.md)

### Workflow Type
1. **Grounding** : codebase_search (si exploration n√©cessaire)
2. **Lecture** : quickfiles read_multiple_files si >2 fichiers
3. **Modification** : apply_diff ou quickfiles edit_multiple_files
4. **Tests** : Validation modifications
5. **Escalade** : Si complexit√© d√©passe crit√®res (<50 lignes)
```

---

## üîç Recherche et Navigation

### Par Besoin

| Besoin | Document Principal | Documents Compl√©mentaires |
|--------|-------------------|---------------------------|
| Commencer nouvelle t√¢che | [`sddd-protocol-4-niveaux.md`](sddd-protocol-4-niveaux.md) | [`mcp-integrations-priority.md`](mcp-integrations-priority.md) |
| D√©composer t√¢che complexe | [`hierarchie-numerotee-subtasks.md`](hierarchie-numerotee-subtasks.md) | [`escalade-mechanisms-revised.md`](escalade-mechanisms-revised.md) |
| √âconomiser tokens | [`context-economy-patterns.md`](context-economy-patterns.md) | [`mcp-integrations-priority.md`](mcp-integrations-priority.md) |
| Escalader/D√©sescalader | [`escalade-mechanisms-revised.md`](escalade-mechanisms-revised.md) | [`context-economy-patterns.md`](context-economy-patterns.md) |
| Utiliser MCPs efficacement | [`mcp-integrations-priority.md`](mcp-integrations-priority.md) | [`context-economy-patterns.md`](context-economy-patterns.md) |
| Cr√©er script/workflow | [`operational-best-practices.md`](operational-best-practices.md) | [`sddd-protocol-4-niveaux.md`](sddd-protocol-4-niveaux.md) |
| Organiser fichiers/rapports | [`operational-best-practices.md`](operational-best-practices.md) | [`sddd-protocol-4-niveaux.md`](sddd-protocol-4-niveaux.md) |
| Choisir mod√®le LLM appropri√© | [`llm-modes-mapping.md`](llm-modes-mapping.md) | [`escalade-mechanisms-revised.md`](escalade-mechanisms-revised.md) |
| Optimiser co√ªts LLM | [`llm-modes-mapping.md`](llm-modes-mapping.md) | [`context-economy-patterns.md`](context-economy-patterns.md) |
| Cr√©er nouveau mode | [`factorisation-commons.md`](factorisation-commons.md) | Tous les autres |

#### Grounding S√©mantique Multi-Niveaux

- **SDDD Niveau 1-4** : [`sddd-protocol-4-niveaux.md`](sddd-protocol-4-niveaux.md)
  - Niveau 1 (File) : Recommandation **quickfiles** (Tier 1)
  - Niveau 3 (Conversational) : MCP **roo-state-manager** (Tier 1)
  - Niveau 4 (Project) : MCP **github-projects** (Tier 1 - Futur)
- **Hi√©rarchisation MCPs** : [`mcp-integrations-priority.md`](mcp-integrations-priority.md)
  - Tier 1 : roo-state-manager, quickfiles, github-projects
  - Tier 2 : win-cli (FB-06), markitdown
  - Tier 3 : github (avec pr√©cautions)

#### MCPs : Recommandations et Installation

- **Strat√©gie MCPs** : [`mcp-integrations-priority.md`](mcp-integrations-priority.md)
  - D√©cision FB-06 : win-cli privil√©gi√©
  - Migration : git MCP ‚Üí git CLI natif
  - Roadmap github-projects (Q4 2025 - Q2 2026)
- **Installation MCPs** : [`../../mcps/INSTALLATION.md`](../../mcps/INSTALLATION.md)
  - win-cli : Compilation TypeScript
  - markitdown : Installation uv (Python)

#### √âvolution Architecture SDDD

- **Niveau 4 Grounding Projet** : [`sddd-protocol-4-niveaux.md#niveau-4`](sddd-protocol-4-niveaux.md#niveau-4)
  - Vision : T√¢ches Roo ‚Üî Issues GitHub
  - Roadmap github-projects : Q4 2025 - Q2 2026
  - Phase 1 : Configuration (Q4 2025)
  - Phase 2 : Int√©gration orchestrator (Q1 2026)
  - Phase 3 : Synchronisation compl√®te (Q2 2026)

### Par Mot-Cl√©

- **codebase_search** ‚Üí [`sddd-protocol-4-niveaux.md`](sddd-protocol-4-niveaux.md)
- **switch_mode** ‚Üí [`escalade-mechanisms-revised.md`](escalade-mechanisms-revised.md)
- **new_task** ‚Üí [`hierarchie-numerotee-subtasks.md`](hierarchie-numerotee-subtasks.md)
- **scripts** ‚Üí [`operational-best-practices.md`](operational-best-practices.md)
- **nomenclature** ‚Üí [`operational-best-practices.md`](operational-best-practices.md)
- **horodatage** ‚Üí [`operational-best-practices.md`](operational-best-practices.md)
- **quickfiles** ‚Üí [`mcp-integrations-priority.md`](mcp-integrations-priority.md)
- **checkpoint** ‚Üí [`context-economy-patterns.md`](context-economy-patterns.md)
- **templates** ‚Üí [`factorisation-commons.md`](factorisation-commons.md)
- **roo-state-manager** ‚Üí [`mcp-integrations-priority.md`](mcp-integrations-priority.md), [`sddd-protocol-4-niveaux.md`](sddd-protocol-4-niveaux.md)
- **github-projects** ‚Üí [`mcp-integrations-priority.md`](mcp-integrations-priority.md), [`sddd-protocol-4-niveaux.md`](sddd-protocol-4-niveaux.md)
- **win-cli** ‚Üí [`mcp-integrations-priority.md`](mcp-integrations-priority.md)
- **markitdown** ‚Üí [`mcp-integrations-priority.md`](mcp-integrations-priority.md)
- **File Grounding** ‚Üí [`sddd-protocol-4-niveaux.md`](sddd-protocol-4-niveaux.md)
- **Semantic Grounding** ‚Üí [`sddd-protocol-4-niveaux.md`](sddd-protocol-4-niveaux.md)
- **Conversational Grounding** ‚Üí [`sddd-protocol-4-niveaux.md`](sddd-protocol-4-niveaux.md)
- **Project Grounding** ‚Üí [`sddd-protocol-4-niveaux.md`](sddd-protocol-4-niveaux.md)
- **Niveau 1** ‚Üí [`sddd-protocol-4-niveaux.md`](sddd-protocol-4-niveaux.md)
- **Niveau 2** ‚Üí [`sddd-protocol-4-niveaux.md`](sddd-protocol-4-niveaux.md)
- **Niveau 3** ‚Üí [`sddd-protocol-4-niveaux.md`](sddd-protocol-4-niveaux.md)
- **Niveau 4** ‚Üí [`sddd-protocol-4-niveaux.md`](sddd-protocol-4-niveaux.md)
- **4-niveaux** ‚Üí [`sddd-protocol-4-niveaux.md`](sddd-protocol-4-niveaux.md)
- **FB-06** ‚Üí [`mcp-integrations-priority.md`](mcp-integrations-priority.md)
- **Tier 1** ‚Üí [`mcp-integrations-priority.md`](mcp-integrations-priority.md)
- **Tier 2** ‚Üí [`mcp-integrations-priority.md`](mcp-integrations-priority.md)
- **Tier 3** ‚Üí [`mcp-integrations-priority.md`](mcp-integrations-priority.md)
- **git MCP** ‚Üí [`mcp-integrations-priority.md`](mcp-integrations-priority.md)
- **git CLI natif** ‚Üí [`mcp-integrations-priority.md`](mcp-integrations-priority.md)
- **Q4 2025** ‚Üí [`sddd-protocol-4-niveaux.md`](sddd-protocol-4-niveaux.md), [`mcp-integrations-priority.md`](mcp-integrations-priority.md)
- **Q1 2026** ‚Üí [`sddd-protocol-4-niveaux.md`](sddd-protocol-4-niveaux.md), [`mcp-integrations-priority.md`](mcp-integrations-priority.md)
- **Q2 2026** ‚Üí [`sddd-protocol-4-niveaux.md`](sddd-protocol-4-niveaux.md), [`mcp-integrations-priority.md`](mcp-integrations-priority.md)
- **win-cli compilation** ‚Üí [`mcps/INSTALLATION.md`](../../mcps/INSTALLATION.md)
- **markitdown uv** ‚Üí [`mcps/INSTALLATION.md`](../../mcps/INSTALLATION.md)
- **Python 3.13.7** ‚Üí [`mcps/INSTALLATION.md`](../../mcps/INSTALLATION.md)
- **LLM** ‚Üí [`llm-modes-mapping.md`](llm-modes-mapping.md)
- **SOTA** ‚Üí [`llm-modes-mapping.md`](llm-modes-mapping.md)
- **Flash** ‚Üí [`llm-modes-mapping.md`](llm-modes-mapping.md)
- **Mini** ‚Üí [`llm-modes-mapping.md`](llm-modes-mapping.md)
- **tiers LLM** ‚Üí [`llm-modes-mapping.md`](llm-modes-mapping.md)
- **escalade tokens** ‚Üí [`llm-modes-mapping.md`](llm-modes-mapping.md), [`escalade-mechanisms-revised.md`](escalade-mechanisms-revised.md)
- **mapping modes** ‚Üí [`llm-modes-mapping.md`](llm-modes-mapping.md)
- **budget tokens** ‚Üí [`llm-modes-mapping.md`](llm-modes-mapping.md), [`context-economy-patterns.md`](context-economy-patterns.md)
- **Claude Sonnet 4** ‚Üí [`llm-modes-mapping.md`](llm-modes-mapping.md)
- **Claude 3.5 Haiku** ‚Üí [`llm-modes-mapping.md`](llm-modes-mapping.md)
- **GPT-4o** ‚Üí [`llm-modes-mapping.md`](llm-modes-mapping.md)
- **optimisation co√ªts** ‚Üí [`llm-modes-mapping.md`](llm-modes-mapping.md)

---

## ‚ö†Ô∏è Notes Importantes

### Compatibilit√©

- ‚úÖ **Architecture 2-niveaux** : Simple/Complex (12 modes op√©rationnels)
- ‚è≥ **Architecture n5** : Non incluse (future √©volution si n√©cessaire)
- ‚úÖ **Modes natifs Roo** : Compatible (5 modes natifs pr√©serv√©s)

### Maintenance

**Modification sp√©cifications** :
1. √âditer document sp√©cialis√© concern√©
2. Mettre √† jour README.md si structure change
3. R√©g√©n√©rer templates si factorisation affect√©e
4. Valider coh√©rence inter-documents

**Ajout nouveau mode** :
1. Identifier famille (CODE, DEBUG, ARCHITECT, ASK, ORCHESTRATOR)
2. Utiliser template famille appropri√©
3. Personnaliser section mode-sp√©cifique (<5% contenu)
4. Int√©grer dans custom_modes.json

---

## üìö Ressources Externes

### Documentation Roo-Code

- [Architecture Modes √âcosyst√®me](../../docs/roo-code/architecture-modes-ecosysteme.md)
- [Analyse Modes Natifs vs Personnalis√©s](../reports/analyse-modes-natifs-vs-personnalises-20250928.md)

### MCPs R√©f√©renc√©s

- **roo-state-manager** : [`mcps/internal/servers/roo-state-manager/`](../../mcps/internal/servers/roo-state-manager/)
- **quickfiles** : [`mcps/internal/servers/quickfiles-server/`](../../mcps/internal/servers/quickfiles-server/)
- **github-projects** : [`mcps/internal/servers/github-projects-mcp/`](../../mcps/internal/servers/github-projects-mcp/)

---

## üìû Contact et Contribution

Pour questions, suggestions ou contributions concernant ces sp√©cifications :

1. **Issues Architecture** : Cr√©er issue GitHub avec tag `architecture`
2. **Discussions** : Utiliser GitHub Discussions
3. **Pull Requests** : Proposer modifications avec justification d√©taill√©e

---

**Version** : 1.0.0  
**Derni√®re Mise √† Jour** : 30 Septembre 2025  
**Auteur** : Roo Architect Mode  
**Statut** : ‚úÖ Sp√©cifications consolid√©es pr√™tes pour impl√©mentation

---

## üìã Rapports de Suivi

### R√©pertoire reports/

- **[`reports/FEEDBACKS-REVISION-PLAN.md`](reports/FEEDBACKS-REVISION-PLAN.md)** : Plan r√©vision 8 feedbacks utilisateur (FB-01 √† FB-08)
- **[`reports/RAPPORT-CORRECTIONS-NUMEROTATION.md`](reports/RAPPORT-CORRECTIONS-NUMEROTATION.md)** : Audit format `1.x.y` (FB-07)
- **[`reports/RAPPORT-VALIDATION-FINALE.md`](reports/RAPPORT-VALIDATION-FINALE.md)** : ‚úÖ **Validation finale Mission 2.1**

---

**Note Finale** : Ces sp√©cifications repr√©sentent la base architecturale **valid√©e et consolid√©e** pour l'√©cosyst√®me des modes Roo. Mission 2.1 COMPL√âT√âE avec **98% coh√©rence**, **0 angle mort**, et **architecture 3-niveaux pr√™te pour impl√©mentation 5-7h**.